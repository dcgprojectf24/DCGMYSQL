<!DOCTYPE html>
<html>
<head>
<title>Report Results</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="./css/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<script src="./functions.js"></script>
<style>
body,h1,h2,h3,h4,h5,h6 {font-family: "Raleway", Arial, Helvetica, sans-serif}
</style>
</head>
<body class="w3-light-grey">
<!---------------------------- Navigation Bar Start ---------------------------->
<script>navBar();</script>
<!---------------------------- Navigation Bar End ---------------------------->
   <script>
        document.addEventListener("DOMContentLoaded", () => {
            const params = new URLSearchParams(window.location.search);
            const reportType = params.get("reportType");
        
            if (reportType) {
                fetch(`/api/reports?reportType=${reportType}`)
                    .then(response => response.json())
                    .then(data => displayReportAsTable(data, reportType))
                    .catch(error => console.error("Error fetching report:", error));
            }
        });
        
        function displayReportAsTable(data, reportType) {
            const container = document.createElement("div");
            document.body.appendChild(container);
        
            let title = "";
            switch (reportType) {
                case "1": title = "Location Frequency Report"; break;
                case "2": title = "Government Agency Report"; break;
                case "3": title = "Distribution Report"; break;
                case "4": title = "Monthly Document Report"; break;
            }
        
            // Create table
            const table = document.createElement("table");
            table.border = "1";
            table.style.borderCollapse = "collapse";
            table.style.width = "80%";
            table.style.margin = "20px auto";
            table.style.textAlign = "left";
        
            // Add table header
            const headerRow = document.createElement("tr");
            Object.keys(data[0]).forEach(key => {
                const th = document.createElement("th");
                th.textContent = key.replace(/_/g, " "); // Clean up column names
                th.style.padding = "8px";
                th.style.backgroundColor = "#f2f2f2";
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);
        
            // Add table rows
            data.forEach(row => {
                const tr = document.createElement("tr");
                Object.values(row).forEach(value => {
                    const td = document.createElement("td");
                    td.textContent = value;
                    td.style.padding = "8px";
                    tr.appendChild(td);
                });
                table.appendChild(tr);
            });
        
            // Add title and table to container
            container.innerHTML = `<h2 style="text-align:center;">${title}</h2>`;
            container.appendChild(table);
        }
        </script>
        
        
</body>
</html>
